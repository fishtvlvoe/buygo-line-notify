# Phase 13 Plan 03: [buygo_line_login] Shortcode

## 目標

建立 `[buygo_line_login]` shortcode，讓站長可以在任何頁面插入 LINE 登入按鈕

## 功能需求

**FRONTEND-03**: `[buygo_line_login]` shortcode
- 顯示 LINE 登入按鈕（與 LoginButtonService 樣式一致）
- 支援參數：
  - `redirect_url` - 登入後導向 URL（可選）
  - `button_text` - 自訂按鈕文字（可選，預設使用後台設定）
  - `button_class` - 自訂 CSS class（可選）
- 已登入用戶：顯示「您已登入」或隱藏按鈕（可配置）

## 實作步驟

### Task 1: 建立 Shortcode Handler

**位置**: `includes/shortcodes/class-login-button-shortcode.php`

**功能**:
- `register()` - 註冊 shortcode
- `render($atts)` - 渲染按鈕 HTML
- 解析參數（redirect_url, button_text, button_class）
- 已登入用戶處理邏輯

**Shortcode 參數**:
```php
$atts = shortcode_atts([
    'redirect_url' => '',       // 登入後導向 URL
    'button_text' => '',        // 自訂按鈕文字
    'button_class' => '',       // 自訂 CSS class
    'show_when_logged_in' => 'no', // yes/no - 已登入時是否顯示
], $atts);
```

### Task 2: 重用 LoginButtonService 樣式

不重複定義 CSS，而是：
- 使用相同的 class names
- 呼叫 LoginButtonService 的 render 邏輯（或抽取共用方法）
- 確保樣式一致性

### Task 3: 整合到 Plugin

修改 `includes/class-plugin.php`:
- 載入 `LoginButtonShortcode`
- 在 `onInit()` 中註冊 shortcode

### Task 4: 範例使用說明

建立文件說明如何使用 shortcode：

```
基本用法：
[buygo_line_login]

自訂按鈕文字：
[buygo_line_login button_text="使用 LINE 登入"]

指定登入後導向：
[buygo_line_login redirect_url="https://example.com/my-account/"]

已登入時仍顯示（顯示「您已登入」訊息）：
[buygo_line_login show_when_logged_in="yes"]

組合使用：
[buygo_line_login button_text="LINE 快速登入" redirect_url="/checkout/" button_class="custom-class"]
```

## 驗證標準

- [ ] `[buygo_line_login]` 可在任何頁面/文章中插入
- [ ] 按鈕樣式與 LoginButtonService 一致
- [ ] 參數正確解析並生效
- [ ] 已登入用戶顯示適當訊息或隱藏按鈕
- [ ] 點擊按鈕啟動 OAuth 流程
- [ ] redirect_url 參數正確傳遞

## 檔案清單

**新增**:
- `includes/shortcodes/class-login-button-shortcode.php`

**修改**:
- `includes/class-plugin.php`
